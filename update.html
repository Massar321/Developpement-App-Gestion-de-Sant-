<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="keywords"
        content="tailwind,tailwindcss,tailwind css,css,starter template,free template,admin templates, admin template, admin dashboard, free tailwind templates, tailwind example">
    <!-- Css -->
    <link rel="stylesheet" href="./dist/styles.css">
    <link rel="stylesheet" href="./dist/all.css">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i,700,700i" rel="stylesheet">
    <title>Dashboard | Tailwind Admin</title>
</head>

<body>
    <!--Container -->
    <div class="mx-auto bg-grey-400">
        <!--Screen-->
        <div class="min-h-screen flex flex-col">
            <!--Header Section Starts Here-->
            <header class="bg-nav">
                <div class="flex justify-between">
                    <div class="p-1 mx-3 inline-flex items-center">
                        <i class="fas fa-bars pr-2 text-white" onclick="sidebarToggle()"></i>
                        <h1 class="text-white p-2">MY API</h1>
                    </div>
                </div>
            </header>
            <!--/Header-->

            <div class="flex flex-1">
                <!--Sidebar-->
                <aside id="sidebar"
                    class="bg-side-nav w-1/2 md:w-1/6 lg:w-1/6 border-r border-side-nav hidden md:block lg:block">
  
                    <ul class="list-reset flex flex-col">
                        <li class=" w-full h-full py-3 px-2 border-b border-light-border">
                            <a href="index.html"
                               class="font-sans font-hairline hover:font-normal text-sm text-nav-item no-underline">
                                <i class="fa fa-list float-left mx-2"> List patient</i>
                               
                            </a>
                        </li>
                        <li class="w-full h-full py-3 px-2 border-b border-light-border ">
                            <a href="add.html"
                               class="font-sans font-hairline hover:font-normal text-sm text-nav-item no-underline">
                                <i class="fa fa-plus float-left mx-2"> Add patient</i>
                               
                            </a>
                        </li>
                    </ul>

                </aside>
                <!--/Sidebar-->
                <!--Main-->
                <main class="bg-white-300 flex-1 p-3 overflow-hidden">

                    <div class="flex flex-col">

                        <!-- Card Sextion Starts Here -->
                        <div class="flex flex-1 flex-col md:flex-row lg:flex-row mx-2">
                            <div class="flex flex-1  flex-col md:flex-row lg:flex-row mx-2">
                                <div class="mb-2 border-solid border-gray-300 rounded border shadow-sm w-full">
                                    <div class="bg-gray-200 px-2 py-3 border-solid border-gray-200 border-b">
                                        Update Patient
                                    </div>
                                    <div class="p-3">
                                        <form class="w-full" id = "form">
                                            <div class="flex flex-wrap -mx-3 mb-6">
                                                <div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
                                                    <label
                                                        class="block uppercase tracking-wide text-gray-700 text-xs font-light mb-1"
                                                        for="grid-first-name">
                                                        Family Name
                                                    </label>
                                                    <input
                                                        class="appearance-none block w-full bg-gray-200 text-black-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white-500 "
                                                        id="grid-first-name" type="text">
                                                </div>
                                                <div class="w-full md:w-1/2 px-3">
                                                    <label
                                                        class="block uppercase tracking-wide text-gray-700 text-xs font-light mb-1"
                                                        for="grid-last-name">
                                                        Given Name
                                                    </label>
                                                    <input
                                                        class="appearance-none block w-full bg-gray-200 text-black-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white-500 "
                                                        id="grid-last-name" type="text">
                                                </div>
                                            </div>

                                            <div class="flex flex-wrap -mx-3 mb-6">
                                                <div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
                                                    <label
                                                        class="block uppercase tracking-wide text-gray-700 text-xs font-light mb-1"
                                                        for="grid-bd">
                                                        Birth Date
                                                    </label>
                                                    <input
                                                        class="appearance-none block w-full bg-gray-200 text-black-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white-500 "
                                                        id="grid-bd" type="date" value="2022-03-01">
                                                </div>
                                            </div>
                                            <div class="flex flex-wrap -mx-3 mb-6">
                                                <div class="w-full px-3">
                                                    <label
                                                        class="block uppercase tracking-wide text-grey-darker text-xs font-light mb-1"
                                                        for="grid-gender">
                                                        Gender
                                                    </label>
                                                    <div class="mt-2">
                                                        <label class="inline-flex items-center">
                                                            <input type="radio" class="form-radio" name="gender"
                                                                id="male" value="male">
                                                            <span class="ml-2">Male</span>
                                                        </label>
                                                        <label class="inline-flex items-center ml-6">
                                                            <input type="radio" class="form-radio" name="gender"
                                                                id="female" value="female">
                                                            <span class="ml-2">Female</span>
                                                        </label>
                                                        <label class="inline-flex items-center ml-6">
                                                            <input type="radio" class="form-radio" name="gender"
                                                                id="other" value="other">
                                                            <span class="ml-2">Other</span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="flex flex-wrap -mx-3 mb-2">
                                                <div class="w-full md:w-1/3 px-3 mb-6 md:mb-0">
                                                    <label
                                                        class="block uppercase tracking-wide text-grey-darker text-xs font-light mb-1"
                                                        for="grid-city">
                                                        City
                                                    </label>
                                                    <input
                                                        class="appearance-none block w-full bg-gray-200 text-black-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white-500 "
                                                        id="grid-city" type="text">
                                                </div>
                                                <div class="w-full md:w-1/3 px-3 mb-6 md:mb-0">
                                                    <label
                                                        class="block uppercase tracking-wide text-grey-darker text-xs font-light mb-1"
                                                        for="grid-state">
                                                        State
                                                    </label>
                                                    <input
                                                        class="appearance-none block w-full bg-gray-200 text-black-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white-500 "
                                                        id="grid-state" type="text">

                                                </div>
                                            </div>

                                            <div class="flex flex-wrap -mx-3 mb-2">
                                                <button id="save"
                                                    class="bg-green-500 hover:bg-green-800 text-white font-bold py-2 px-4 rounded  float-right">
                                                    Save
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <!-- /Cards Section Ends Here -->

                        <!--Profile Tabs-->
                        <!-- <div class="flex flex-1 flex-col md:flex-row lg:flex-row mx-2 p-1 mt-2 mx-auto lg:mx-2 md:mx-2 justify-between">
                                            <div class="rounded rounded-t-lg overflow-hidden shadow max-w-xs my-3">
                                                <img src="https://i.imgur.com/w1Bdydo.jpg" alt="" class="w-full"/>
                                                <div class="flex justify-center -mt-8">
                                                    <img src="https://i.imgur.com/8Km9tLL.jpg" alt=""
                                                         class="rounded-full border-solid border-white border-2 -mt-3">
                                                </div>
                                                <div class="text-center px-3 pb-6 pt-2">
                                                    <h3 class="text-black text-sm bold font-sans">Olivia Dunham</h3>
                                                    <p class="mt-2 font-sans font-light text-grey-700">Hello, i'm from another the other
                                                        side!</p>
                                                </div>
                                                <div class="flex justify-center pb-3 text-grey-dark">
                                                    <div class="text-center mr-3 border-r pr-3">
                                                        <h2>34</h2>
                                                        <span>Photos</span>
                                                    </div>
                                                    <div class="text-center">
                                                        <h2>42</h2>
                                                        <span>Friends</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div> -->
                        <!--/Profile Tabs-->
                    </div>
                </main>
                <!--/Main-->
            </div>

        </div>

    </div>
    <script src="./main.js"></script>
    <script>
        async function res(params) {
            let idd = params.get("data");
            const response = await fetch(`http://hapi.fhir.org/baseDstu3/Patient/${idd}`, {
                method: 'GET'
            });
            const result = await response.json();
            return result;
        }
        let params = new URLSearchParams(window.location.search);
        const result = res(params);
        res(params).then(function (result) {
            console.log(result);
            let t = result;
            document.getElementById("grid-first-name").value = t.name[0].family
            document.getElementById("grid-last-name").value = t.name[0].given
            document.getElementById(t.gender).checked = true
            document.getElementById("grid-city").value = t.address[0].city
            document.getElementById("grid-state").value = t.address[0].state
            document.getElementById("grid-bd").value = t.birthDate
        }).catch(function (error) { console.error(error); });


        document.getElementById('save').addEventListener('click',async (event) => {
            event.preventDefault();
            const idd =  new URLSearchParams(window.location.search).get("data");
            // updatePatient(id);
            
            const formData = new FormData(document.getElementById("form"));
            console.log("formData");
            console.log(formData);
            const data = {
                resourceType: 'Patient',
                id:idd,
                name: [{
                    given: [document.getElementById("grid-last-name").value],
                    family: document.getElementById("grid-first-name").value
                }],
                gender: formData.get('gender'),
                birthDate: document.getElementById("grid-bd").value,
                address: [{
                    use: 'home',
                    state: document.getElementById("grid-state").value,
                    city: document.getElementById("grid-city").value
                }],
               
            };
            console.log(JSON.stringify(data));
            const response = await fetch(`http://hapi.fhir.org/baseDstu3/Patient/${idd}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });
            location.href = "index.html";
        });

    </script>
</body>

</html>